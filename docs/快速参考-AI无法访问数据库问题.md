# 快速参考：AI说"无法访问数据库"问题

## 🎯 一句话总结

**这不是系统错误，而是AI的训练偏见导致的理解偏差，已通过强化提示词修复。**

---

## ⚡ 快速诊断

### 问题现象
AI回复包含以下任一短语：
- ❌ "我无法访问数据库"
- ❌ "当前环境不支持直接访问数据库"
- ❌ "请您自己执行"
- ❌ "如果您提供查询结果"

### 问题原因
- **不是**系统功能问题
- **不是**数据源配置问题
- **是**AI的训练偏见问题

---

## 🔧 快速修复

### 1. 重启后端服务
```bash
docker restart dataagent-backend
```

### 2. 验证修复
```bash
python scripts/test-ai-no-database-access-fix.py
```

### 3. 预期结果
AI应该回复：
```
要查询XXX，可以使用以下SQL：

```sql
SELECT ...
```

系统会自动执行查询并显示结果。
```

---

## 📋 检查清单

- [ ] 后端服务已重启
- [ ] 数据源状态为ACTIVE
- [ ] 加密密钥配置正确
- [ ] AI回复不包含禁止短语
- [ ] AI回复包含SQL代码块
- [ ] SQL查询被自动执行
- [ ] 查询结果正确显示

---

## 🆘 故障排查

### 如果问题仍然出现

1. **查看后端日志**：
   ```bash
   docker logs dataagent-backend --tail 100
   ```

2. **检查数据源**：
   - 确保租户有活跃的数据源
   - 验证连接字符串正确

3. **检查提示词**：
   - 查看 `backend/src/app/api/v1/endpoints/llm.py`
   - 确认修改已生效

4. **联系支持**：
   - 提供AI的完整回复
   - 提供后端日志
   - 提供数据源配置

---

## 📚 详细文档

- [问题解答-为什么显示无法访问数据库.md](./问题解答-为什么显示无法访问数据库.md)
- [BUG修复-AI说无法访问数据库.md](./BUG修复-AI说无法访问数据库.md)

---

**最后更新**: 2025-11-30

