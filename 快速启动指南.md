# Data Agent V4 - 快速启动指南 🚀

**最后更新**: 2025-11-19

---

## 🎯 推荐启动方式

### ⭐ 方式一：混合模式（最推荐）

**适用场景**: 日常开发、前端调试、快速演示

```bash
.\scripts\start-hybrid.bat
```

**优点**:
- ✅ 启动快速（~20秒）
- ✅ 前端热重载快
- ✅ 无Python依赖问题
- ✅ 稳定性好

**服务分布**:
- 后端: Docker容器
- 前端: 本地npm
- 基础设施: Docker容器

---

### 🐳 方式二：完全Docker模式

**适用场景**: 生产环境、完整测试、环境一致性要求高

```bash
.\scripts\docker-start.bat
```

**优点**:
- ✅ 环境完全一致
- ✅ 部署简单
- ✅ 隔离性好

**服务分布**:
- 全部服务: Docker容器

---

### 💻 方式三：完全本地模式

**适用场景**: 深度调试、离线开发

```bash
.\scripts\start-all-local.bat
```

**注意事项**:
- ⚠️ 需要Python 3.8-3.11（不支持3.14）
- ⚠️ Windows需要C++ Build Tools
- ⚠️ 依赖安装可能失败

---

## 📋 启动前检查清单

### 1. 环境要求

- [ ] Node.js 18+ 已安装
- [ ] Docker Desktop 已安装并运行
- [ ] Python 3.8-3.11（如使用本地模式）
- [ ] 端口 3000, 8004, 5432, 9000, 9001, 8001 可用

### 2. 配置文件

- [ ] `.env` 文件已创建（从`.env.example`复制）
- [ ] `ZHIPUAI_API_KEY` 已配置
- [ ] 数据库密码已设置

### 3. 检查端口

```bash
.\scripts\check-ports.ps1
```

---

## 🚀 快速启动步骤

### 首次运行

```bash
# 1. 克隆项目
git clone <repository-url>
cd data_agent

# 2. 配置环境变量
copy .env.example .env
# 编辑 .env 文件，设置必要的配置

# 3. 启动服务（推荐混合模式）
.\scripts\start-hybrid.bat

# 4. 等待服务启动（约20秒）

# 5. 访问应用
# 前端: http://localhost:3000
# 后端: http://localhost:8004/docs
```

### 日常开发

```bash
# 直接启动
.\scripts\start-hybrid.bat

# 或使用Docker模式
.\scripts\docker-start.bat
```

---

## 🌐 服务访问地址

### 前端服务
- 🏠 主页: http://localhost:3000
- 💬 聊天界面: http://localhost:3000/chat
- 📁 数据源管理: http://localhost:3000/data-sources
- 📄 文档管理: http://localhost:3000/documents

### 后端服务
- 📖 API文档: http://localhost:8004/docs
- ✅ 健康检查: http://localhost:8004/health
- 🔌 API根路径: http://localhost:8004/api/v1

### 基础设施服务
- 🗄️ PostgreSQL: localhost:5432
- 📦 MinIO API: http://localhost:9000
- 🎨 MinIO Console: http://localhost:9001
- 🔍 ChromaDB: http://localhost:8001

---

## 🛑 停止服务

### 混合模式
```bash
# 1. 停止前端: Ctrl+C (在前端窗口)
# 2. 停止Docker服务
docker-compose down
```

### Docker模式
```bash
.\scripts\docker-stop.bat
```

---

## ❓ 常见问题

### 1. 端口被占用

**问题**: `Address already in use`

**解决**:
```bash
# 检查端口占用
netstat -ano | findstr :8004

# 停止占用进程
Stop-Process -Id <PID>
```

### 2. Docker服务启动失败

**问题**: `Cannot connect to Docker daemon`

**解决**:
1. 确保Docker Desktop正在运行
2. 重启Docker Desktop
3. 检查Docker设置

### 3. Python依赖安装失败

**问题**: `error: Microsoft Visual C++ 14.0 or greater is required`

**解决**:
- **推荐**: 使用混合模式或Docker模式
- 备选: 安装 [Microsoft C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools/)
- 备选: 降级到Python 3.11

### 4. 前端依赖安装慢

**解决**:
```bash
# 使用国内镜像
npm config set registry https://registry.npmmirror.com
npm install
```

---

## 📊 启动模式对比

| 特性 | 混合模式 | Docker模式 | 本地模式 |
|------|----------|------------|----------|
| 启动速度 | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 热重载 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 稳定性 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 依赖问题 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ |
| 调试便利 | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 📚 更多文档

- [本地虚拟环境启动指南](./docs/本地虚拟环境启动指南.md)
- [Docker运行指南](./docs/本地运行指南.md)
- [脚本工具说明](./scripts/README.md)
- [API文档](./docs/API/README.md)
- [开发指南](./docs/Development/README.md)

---

## 💡 提示

1. **首次运行**: 推荐使用混合模式，体验最好
2. **生产部署**: 使用Docker模式，环境一致
3. **深度调试**: 使用本地模式，但需要解决依赖问题
4. **遇到问题**: 查看 `debug/本地启动状态报告.md`

---

**祝开发愉快！** 🎉

